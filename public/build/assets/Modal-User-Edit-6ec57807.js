import{u as E,o as T,p as O,a as U,q as A,r as b,j as e,s as I,P,h as B}from"./index-e9135fee.js";import{B as F}from"./BaseModal-b4cf7c12.js";import{E as L}from"./EditCoverDroppable-9aee31f6.js";function z(s){var u,p,f,x,w,h,j,v;const[a]=E(),[N]=T(t=>[t.updateItem]),{user:g,setUser:M}=O(),{formState:{errors:r},register:n,handleSubmit:C,watch:V}=U(),o=(u=s==null?void 0:s.data)!=null&&u.image?(p=s==null?void 0:s.data)==null?void 0:p.image:A,[d,y]=b.useState(o),i=s.data,[m,S]=b.useState({}),_=(t,l)=>{S(l)},q=async t=>{I();const l=new FormData;d&&d!==o&&l.append("image",d),m&&Object.hasOwn(m,"x")&&l.append("crop",JSON.stringify(m)),t.password&&l.append("password",t.password),l.append("name",t.name),l.append("email",t.email),t.new_password!=""&&l.append("new_password",t.new_password),P.updateUser(i==null?void 0:i.id,l).then(c=>{B(),N(c==null?void 0:c.data)}),s.onClose()};return e.jsx(F,{title:a("profile.title"),show:s.isOpen,onClose:s.onClose,children:e.jsxs("form",{onSubmit:C(q),encType:"multipart/form-data",children:[e.jsx(L,{cover:o,setCover:y,saveCrop:_}),g.is_admin!==1&&e.jsxs("div",{className:"form-field",children:[e.jsx("label",{children:a("profile.current_password")}),e.jsx("input",{type:"password",className:"w-full form-input",...n("password",{required:{value:!0,message:a("edit.required")}})}),((f=r.password)==null?void 0:f.message)&&e.jsx("div",{className:"validationText",children:(x=r.password)==null?void 0:x.message}),e.jsx("p",{children:a("profile.password_hint")})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("label",{children:a("profile.name")}),e.jsx("input",{type:"text",className:"w-full form-input",defaultValue:i==null?void 0:i.name,...n("name",{required:{value:!0,message:a("edit.required")}})}),((w=r.name)==null?void 0:w.message)&&e.jsx("div",{className:"validationText",children:(h=r.name)==null?void 0:h.message})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("label",{children:a("profile.email")}),e.jsx("input",{type:"email",className:"w-full form-input",defaultValue:i==null?void 0:i.email,...n("email",{required:{value:!0,message:a("edit.required")}})}),((j=r.email)==null?void 0:j.message)&&e.jsx("div",{className:"validationText",children:(v=r.email)==null?void 0:v.message})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("label",{children:a("profile.new_password")}),e.jsx("input",{type:"password",className:"w-full form-input",...n("new_password")})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{onClick:s.onClose,type:"button",className:"btn btn-close mr-2","data-bs-dismiss":"modal","aria-label":"Close",children:a("close")}),e.jsx("button",{className:"btn btn-primary",type:"submit",children:a("save")})]})]})})}export{z as default};
