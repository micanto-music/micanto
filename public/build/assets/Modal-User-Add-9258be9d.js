import{u as U,o as I,p as P,a as B,q as F,r as u,j as e,s as M,P as V,h as k}from"./index-e9135fee.js";import{B as G}from"./BaseModal-b4cf7c12.js";import{E as J}from"./EditCoverDroppable-9aee31f6.js";function Q(a){var x,h,j,v,w,b,g,N;const[s]=U(),[q]=I(d=>[d.addItem]),{user:E,setUser:R}=P(),{formState:{errors:i},register:n,handleSubmit:T,watch:z}=B(),o=(x=a==null?void 0:a.data)!=null&&x.image?(h=a==null?void 0:a.data)==null?void 0:h.image:F,[m,_]=u.useState(o),[f,p]=u.useState();let r={};const[c,A]=u.useState({}),L=(d,l)=>{A(l)},O=async d=>{M();const l=new FormData;m&&m!==o&&l.append("image",m),c&&Object.hasOwn(c,"x")&&l.append("crop",JSON.stringify(c)),l.append("name",d.name),l.append("email",d.email),l.append("password",d.new_password),V.addUser(l).then(t=>{k(),q(t==null?void 0:t.data),a.onClose()}).catch(t=>{var y,S;let C=(S=(y=t==null?void 0:t.response)==null?void 0:y.data)==null?void 0:S.message;p(C||null)})};return e.jsx(G,{title:s("userList.add"),show:a.isOpen,onClose:a.onClose,children:e.jsxs("form",{onSubmit:T(O),encType:"multipart/form-data",children:[e.jsx(J,{cover:o,setCover:_,saveCrop:L}),E.is_admin!==1&&e.jsxs("div",{className:"form-field",children:[e.jsx("label",{children:s("profile.current_password")}),e.jsx("input",{type:"password",className:"w-full form-input",...n("password",{required:{value:!0,message:s("edit.required")}})}),((j=i.password)==null?void 0:j.message)&&e.jsx("div",{className:"validationText",children:(v=i.password)==null?void 0:v.message}),e.jsx("p",{children:s("profile.password_hint")})]}),f&&e.jsx("div",{className:"global-form-error validationText",children:s(f)}),e.jsxs("div",{className:"form-field",children:[e.jsx("label",{children:s("profile.name")}),e.jsx("input",{type:"text",className:"w-full form-input",defaultValue:r==null?void 0:r.name,...n("name",{required:{value:!0,message:s("edit.required")}})}),((w=i.name)==null?void 0:w.message)&&e.jsx("div",{className:"validationText",children:(b=i.name)==null?void 0:b.message})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("label",{children:s("profile.email")}),e.jsx("input",{type:"email",className:"w-full form-input",defaultValue:r==null?void 0:r.email,...n("email",{required:{value:!0,message:s("edit.required")}})}),((g=i.email)==null?void 0:g.message)&&e.jsx("div",{className:"validationText",children:(N=i.email)==null?void 0:N.message})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("label",{children:s("userList.password")}),e.jsx("input",{type:"password",className:"w-full form-input",...n("new_password")})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{onClick:a.onClose,type:"button",className:"btn btn-close mr-2","data-bs-dismiss":"modal","aria-label":"Close",children:s("close")}),e.jsx("button",{className:"btn btn-primary",type:"submit",children:s("save")})]})]})})}export{Q as default};
